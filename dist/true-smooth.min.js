var TrueSmoothService=function(t){this.register(t)};TrueSmoothService.prototype.register=function(t){this.getScrollDistance=(()=>window.pageYOffset||(document.documentElement||document.body.parentNode||document.body).scrollTop),this.onScroll=(t=>{this.registerServiceScroll(this,t)}),this.registerItem=(e=>new TrueSmoothItem(e,t));var e=new Event("ts.resize.debounced");return window.addEventListener("resize",function(t,e){var o,e=e||200;return()=>{var i=this,n=arguments;clearTimeout(o),o=setTimeout(()=>{o=null,t.apply(i,n)},e)}}(()=>{window.dispatchEvent(e)})),this.onViewportResize=(t=>{window.addEventListener("ts.resize.debounced",()=>{t({width:window.innerWidth,height:window.innerHeight})})}),this};var TrueSmoothItem=function(t,e){return this.error=[],this.instance=e,this.el=t,this.anchor=null,this.state="initial",this.offsetY=0,this.zIndex=t.dataset.zIndex||1,this.scrollRatio=t.dataset.scrollRatio||1,this.initialStyle={},this.setInitialStyle(),this.setAnchor(),this.error.length&&console.log(this.error),this};TrueSmoothItem.prototype.scroll=function(t){if("scroll"===this.state)return;this.state="scroll",console.log("keep scrolling"),this.el.style.position="fixed";let e=0;e+=parseInt(this.initialStyle.top),e+=parseInt(this.initialStyle.marginTop),this.el.style.transform="translate3d(0, "+e+"px, 0)"},TrueSmoothItem.prototype.scrollAnchor=function(t){if("anchored"===this.state)return;this.state="anchored",console.log("STOP scrolling",this.getOffsetY(t)),this.el.style.position="absolute";let e=this.anchor.offsetY;"bottom"===this.anchor.itemPoint&&(e-=parseInt(this.el.offsetHeight)),this.el.style.transform="translate3d(0, "+e+"px, 0)"},TrueSmoothItem.prototype.getOffsetY=function(t){let e=this.offsetY;return"bottom"===this.anchor.itemPoint&&(e+=this.el.offsetHeight),e+=t},TrueSmoothItem.prototype.setInitialStyle=function(){this.initialStyle={};let t=window.getComputedStyle(this.el);["position","top","right","bottom","left","marginTop"].forEach(e=>{this.initialStyle[e]=t[e]||null}),this.el.style.top="0px",this.el.style.marginTop="0px";let e=0;e+=parseInt(this.initialStyle.top),e+=parseInt(this.initialStyle.marginTop),this.el.style.transform="translate3d(0, "+e+"px, 0)",this.offsetY=e},TrueSmoothItem.prototype.setAnchor=function(){if(this.anchor={},this.el.dataset.anchor){let t=this.el.dataset.anchor.split(":");if(this.anchor.selector=t[0],this.anchor.point=t[1]||null,this.anchor.itemPoint=t[2]||null,this.anchor.anchorMargin=parseInt(t[3])||0,this.anchor.el=this.instance.container,"_parent"!==this.anchor.selector&&(this.anchor.el=document.querySelector(this.anchor.selector)),!this.anchor.el)return void this.error.push("Item not found")}else this.anchor.selector="_parent",this.anchor.point="bottom",this.anchor.itemPoint="bottom",this.anchor.anchorMargin=0,this.anchor.el=this.instance.container;this.anchor.offsetY=this.anchor.el.offsetTop,"bottom"===this.anchor.point&&(this.anchor.offsetY+=this.anchor.el.offsetHeight),this.anchor.offsetY-=this.anchor.anchorMargin},TrueSmoothService.prototype.registerServiceScroll=function(t,e){let o=t.getScrollDistance(),i=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||window.oRequestAnimationFrame;!function n(){let s=t.getScrollDistance();if(o===s)return void i(n);let r=s>o?"down":"up";o=s;e({y:o,dir:r});i(n)}()};var TrueSmooth=function(t){var e=this;this.service=new TrueSmoothService(this),this.container=t,this.items=[],e.container.querySelectorAll("[data-true-smooth-item]").forEach((t,o)=>{e.items.push(e.service.registerItem(t))}),this.service.onScroll(t=>{this.items.forEach(e=>{console.log("offsetY",e.getOffsetY(t.y),e.anchor.offsetY),e.getOffsetY(t.y)>e.anchor.offsetY?e.scrollAnchor(t.y):e.scroll(t.y)})})},container=document.querySelector(".true-smooth"),test=new TrueSmooth(container);