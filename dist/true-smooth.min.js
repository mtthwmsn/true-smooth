var TrueSmoothService=function(t){this.register(t)};TrueSmoothService.prototype.register=function(t){this.getScrollDistance=(()=>window.pageYOffset||(document.documentElement||document.body.parentNode||document.body).scrollTop),this.onScroll=(t=>{this.registerServiceScroll(this,t)}),this.registerItem=(e=>new TrueSmoothItem(e,t));var e=new Event("ts.resize.debounced");return window.addEventListener("resize",function(t,e){var i,e=e||200;return()=>{var o=this,s=arguments;clearTimeout(i),i=setTimeout(()=>{i=null,t.apply(o,s)},e)}}(()=>{window.dispatchEvent(e)})),this.onViewportResize=(t=>{window.addEventListener("ts.resize.debounced",()=>{t({width:window.innerWidth,height:window.innerHeight})})}),this};var TrueSmoothItem=function(t,e){return this.error=[],this.instance=e,this.el=t,this.anchor=null,this.state="initial",this.offsetY=0,this.scrollYOffset=0,this.zIndex=t.dataset.zIndex||1,this.scrollRatio=t.dataset.scrollRatio||1,this.scrollSpring=t.dataset.scrollSpring||1,this.initialStyle={},this.startScrollEvent=new Event("ts.scrollitem.start"),this.endScrollEvent=new Event("ts.scrollitem.stop"),this.setInitialStyle(),this.setAnchor(),this.error.length&&console.log(this.error),this};TrueSmoothItem.prototype.scroll=function(){var t=!1;"scroll"!==this.state&&(this.el.style.position="fixed",this.state="scroll",this.el.dispatchEvent(this.startScrollEvent),"down"===this.instance.scrollDir?this.enableSmoothScroll():t=!0),this.scrollYOffset=this.instance.scrollY*this.scrollRatio-this.instance.scrollY;let e=0;if(e+=parseInt(this.initialStyle.top)||0,e+=parseInt(this.initialStyle.marginTop)||0,e+=this.scrollYOffset,this.el.style.transform="translate3d(0, "+e+"px, 0)",!0===t){var i=this;setTimeout(function(){i.enableSmoothScroll()},0)}},TrueSmoothItem.prototype.scrollAnchor=function(){if("anchored"===this.state)return;this.state="anchored",this.disableSmoothScroll(),this.el.style.position="absolute";let t=this.anchor.offsetY;"bottom"===this.anchor.itemPoint&&(t-=parseInt(this.el.offsetHeight)),this.el.style.transform="translate3d(0, "+t+"px, 0)",this.el.dispatchEvent(this.endScrollEvent)},TrueSmoothItem.prototype.getOffsetY=function(){let t=this.offsetY;return"bottom"===this.anchor.itemPoint&&(t+=this.el.offsetHeight),t+=this.instance.scrollY,t+=this.scrollYOffset},TrueSmoothItem.prototype.setInitialStyle=function(){this.initialStyle={};let t=window.getComputedStyle(this.el);["position","top","right","bottom","left","marginTop"].forEach(e=>{this.initialStyle[e]=t[e]||null}),this.el.style.top="0px",this.el.style.marginTop="0px";let e=0;e+=parseInt(this.initialStyle.top)||0,e+=parseInt(this.initialStyle.marginTop)||0,this.el.style.transform="translate3d(0, "+e+"px, 0)",this.offsetY=e},TrueSmoothItem.prototype.enableSmoothScroll=function(){let t=.1*this.scrollSpring;this.el.style.transition="transform "+t+"s ease"},TrueSmoothItem.prototype.disableSmoothScroll=function(){this.el.style.transition=null},TrueSmoothItem.prototype.setAnchor=function(){if(this.anchor={},this.el.dataset.anchor){let t=this.el.dataset.anchor.split(":");if(this.anchor.selector=t[0],this.anchor.point=t[1]||null,this.anchor.itemPoint=t[2]||null,this.anchor.anchorMargin=parseInt(t[3])||0,this.anchor.el=this.instance.container,"_parent"!==this.anchor.selector&&(this.anchor.el=document.querySelector(this.anchor.selector)),!this.anchor.el)return void this.error.push("Item not found")}else this.anchor.selector="_parent",this.anchor.point="bottom",this.anchor.itemPoint="bottom",this.anchor.anchorMargin=0,this.anchor.el=this.instance.container;this.anchor.offsetY=this.anchor.el.offsetTop,"bottom"===this.anchor.point&&(this.anchor.offsetY+=this.anchor.el.offsetHeight),this.anchor.offsetY-=this.anchor.anchorMargin},TrueSmoothService.prototype.registerServiceScroll=function(t,e){let i=t.getScrollDistance(),o=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||window.oRequestAnimationFrame;!function s(){let r=t.getScrollDistance();if(i===r)return void o(s);let n=r>i?"down":"up";i=r;e({y:i,dir:n});o(s)}()};var TrueSmooth=function(t){var e=this;return this.service=new TrueSmoothService(this),this.container=t,this.items=[],this.scrollY=0,this.scrollDir=null,e.container.querySelectorAll("[data-true-smooth-item]").forEach((t,i)=>{e.items.push(e.service.registerItem(t))}),this.getItems=function(){let t=[];return e.items.forEach(e=>{t.push(e.el)}),t},this.service.onScroll(t=>{this.scrollY=t.y,this.scrollDir=t.dir,this.items.forEach(e=>{e.getOffsetY(t.y)>e.anchor.offsetY?e.scrollAnchor(t.y):e.scroll(t.y)})}),{getItems:this.getItems}};